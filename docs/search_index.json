[
["index.html", "Mobile forms for salmon surveys Welcome", " Mobile forms for salmon surveys Are Strom Welcome The growing popularity of mobile technology for data collection has increased both the types of data, and the volume of data, flowing from field to database. The advantages of mobile devices over paper forms are compelling. Mobile devices enable automated data capture using a wide assortment of sensors, including temperature probes, pH meters, barcode readers, cameras, PIT tag readers, and integrated GPS. In the past, data from a complete spawning ground survey would typically have been entered first in a field notebook, then transcribed to a 3x5 index card, and finally entered to an electronic spreadsheet. The electronic portion would rarely require more than a few kilobytes of memory. By contrast, mobile technology enables capturing a much richer set of data, possibly including binary data such as images or video. Consequently, storage requirements can grow to megabyte size and manual transcription is no longer practical. This, in turn, requires better systems to store, retrieve, and analyze an expanding flow of data. Making sure that data systems are well integrated is becoming increasingly important. At the Washington Department of Fish and Wildlife (WDFW), a new spawning ground database has been constructed to absorb the increased flow, and diversity, of data on the back-end. Integration on the front-end is still a work in progress. This manual was motivated by the need for guidelines and standards at the mobile device end. The aim is two-fold: first, to provide simple examples to assist those just learning to build mobile forms, and second, to document form elements needed to facilitate getting data securely moved from field to database. Building mobile forms can be a source of frustration, even for experienced IT staff. Although it is true that simple forms can be built quickly and easily, even moderately complex forms, such as those typically needed for spawning ground surveys, require a considerable amount of work. Once you start adding conditional logic and validation to your forms you will need to write some code. A formalized set of guidelines, along with step-by-step instructions, can help ease the pain. Standardizing the general structure of mobile forms can also help enable a smooth flow of data from field to back-end database. Although survey protocols vary from region to region, in general, they are similar enough that there is much to be gained from copying what works and learning from each other. To simplify the process of building mobile forms this manual takes a highly opinionated approach. As you gain experience in form building, feel free to customize as needed. But please keep in mind that core elements need to be present in order to enable downloading and processing data so it can be integrated into our corporate spawning ground database. These core elements will be emphasized in the sections that follow. Please consider contributing your own solutions, corrections, or edits to this manual. All source code is available at the project GitHub repository. It is written using the bookdown package. See bookdown: Authoring Books and Technical Documents with R Markdown for technical details on how to contribute. "],
["intro.html", "1 Introduction 1.1 Why mobile forms? 1.2 API 1.3 Profiles 1.4 Useful tips 1.5 Conventions", " 1 Introduction The WDFW Fish Program currently uses iFormBuilder as a platform for building and deploying mobile forms. Although there are numerous alternative mobile platforms, both commercial and open-source, among the benefits of iFormBuilder are an easy-to-use form building application, a robust system for syncing between forms and devices, and an excellent application programming interface (API). The API is particulary useful, as it allows us to automate many of the most burdensome aspects of building forms and managing data flows. 1.1 Why mobile forms? 1.1.1 Trade-offs Mobile electronic forms provide a number of advantages over paper forms, but as always, there are trade-offs. For seasoned surveyors, the field notebook has long proven to be a simple and effective tool to jot down observations. Short-hand comments and codes have been developed that enable recording a great deal of information succinctly and quickly. Switching to mobile forms can slow down data entry in the field, at least initially. This can be frustrating when you have a large number of streams to survey, limited staff, or short windows of opportunity between fall and winter storms to get those surveys completed. Avoiding unnecessary slowdowns and keeping your surveyors happy is important. This is also the main reason for making sure the structure of mobile forms is kept as simple as possible. Minimizing the number of subforms can speed up data entry in the field. Conditionally hiding data elements until they are truly needed keep forms streamlined and free of unneeded clutter. But regardless of how simple the form, there will still be some pain to begin with. That pain will go away in time, especially as the benefits of using mobile forms become more apparent. If your survey protocols are relatively simple, and you are only interested in recording a few core data elements, the benefits of mobile survey forms may not be immediately apparent. It is only when the entire process of capturing, recording, transcribing, proofing, analyzing data, and finally, using the data to calculate population estimates is all taken into account that the true efficiencies become compelling. 1.1.2 Automated, integrated, data capture Mobile forms allow capturing data using a variety of sensors quickly and accurately. Those data are then fully integrated with all your other observations. A good example is location data. It can often be useful to map locations of salmon redds to understand density over time, or see how changes in habitat have affected populations in a particular section of a creek or river. Using a typical combination of field notebook and a separate GPS unit, considerable work is required to download, proof, and integrate the location data with the field notebook data. Both the field notebook data and GPS data needs to be separately entered, proofed, and finally combined. Mobile devices include integrated GPS, and output integrated data. There is no need for manually combining disparate sets of data after the survey. 1.1.3 Enter once Mobile forms avoid the need to transcribe data from a field notebook or write-in-the-rain datasheets to electronic format. Data only needs to be entered once. This avoids common transcription errors that can often be notoriously hard to spot. After the Done button has been clicked on the mobile device, the data can then be automatically written to our corporate database with no additional effort on the part of the surveyor or supervisor. After the data has been written to the central database it can be inspected, edited if needed, and exported for reports or analysis. 1.1.4 Validation Another advantage of mobile forms is data integrity. Common errors can be automatically detected while still in the field by adding validation code directly into your forms. An unusual value can be flagged and the surveyor immediately asked to verify the suspect value before submitting. Validation code can be as simple or elaborate as needed. It is normal to add additional validation code after you launch a mobile form and you start to notice where errors tend to occur. An especially useful feature of mobile forms is that you can add validation or other features as you progress through the season. Your surveyors then just need to sync their forms to get the lastest updates. 1.1.5 Reporting For biologists, an added bonus of mobile forms is a clean set of data that is housed in a predictable format, and securely backed up. With proper validation on the front-end, data transmitted from mobile form to back-end database is immediately available for reporting and analysis. Clean data, organized in a consistent format can make it easier to produce population estimates and reports. 1.2 API As mentioned earlier, a major benefit of using the iFormBuilder platform for building and deploying mobile forms is the application programming interface, or API. An API is simply a set of protocols that allows computers to talk to one another. One case where the API can avoid a great deal of pain is in constructing large filtered option lists. The prime example for spawning ground surveys are the drop-down pick-lists for survey start and stop points along a given stream. Lists with thousands of elements can be constructed and uploaded to the iFormBuilder cloud in seconds. The iformr package provides a set of functions that allows for using R scripts to automate many of these types of tasks. Instructions for how to get started can be found in package GitHub repository. 1.3 Profiles Since the source code for this manual is hosted on a public website, I will not go into detail on setting up devices, assigning AppleIDs, Google Play store accounts, or connecting to the WDFW iFormBuider account. The only prerequiste that needs to be stressed here is that you will want to get a separate iFormBuilder Profile set up for your workgroup. The main benefit is that it keeps your forms and option lists segregated from other groups, and makes it less likely you will lose data because someone accidentally edited your form…or deleted an option list. Contact me if you need help to get this set up. 1.4 Useful tips 1.4.1 Searching for help There is a great deal of information available at the iFormBuilder website for learning how to build forms. This includes an extensive list of videos. Unfortunately, that information is not always well organized. You can often get better results doing your own internet search and prefacing a general search term such as parse location with iformbuilder, rather than using iFormBuilder’s help pages. That said, the Customer Success Center is still a good place to start. If you have not already done so, watch the Art of Form Building video for an introduction to best practices. At some point you will need to write simple JavaScript code. This is especially important when you want to create conditional logic to hide or show a data element, validate data, or sum up a set of counts. My favorite site for help with JavaScript is w3schools. If you need to do something more complex, you will usually find that someone has already written a function to accomplish exactly what you want. Try searching on stackoverflow. In addition, there is a selection of commonly used JavaScript functions located in the appendix section of this manual. 1.4.2 Data column names When adding new data elements to your form keep in mind that the data_column names must be what is termed database friendly. They must all be in lower case, and you cannot use compound words, such as redd count without first tying the words together using an underscore. For example, redd_count. There is also a long list of reserved words that you cannot use for data_column names. These can be downloaded from the link above. 1.4.3 Option lists Always remember that option lists can be shared among different forms. This means that whenever you edit an option lists you are changing options for all forms that share the list. This can cause severe problems with other mobile forms in your profile if you are not careful. 1.4.4 Save often When building forms, remember to Save frequently. Best practice is to get into the habit of clicking the save icon in the upper right-hand corner of the form builder interface every time you make a change. Few things are more annoying than to make a series of changes to a form, then later realize that all your work has dissapeared because you forgot to save. 1.5 Conventions This manual is meant to be an interactive resource for those learning to build mobile forms using the iFormBuilder platform. As such, there are numerous links to outside resources included. These are highlighted in blue. For example: w3schools. You will also find snippets of code that can be copied and pasted directly from this manual to your forms. These are entered to code blocks such as: if(species == 3 &amp;&amp; redd_status == 0) {&quot;Yes&quot;} else {&quot;No&quot;} Code blocks are also used to highlight text, code, or numbers that you enter directly into the form builder web application when designing forms. For example: ZCDisplayValue_stream, or the number -1, or data column names such as survey_method. Screenshots are liberally included to help identify where commands are located in the form builder application. Bold text is used to bring attention to items of particular importance, such as Save often. Finally, suggestions are always welcome on how to improve this manual. If you find errors, discover cases where conventions are not followed, locate additional outside resources that should be linked, or identify places where additional screenshots would be helpful, please let me know. You can file issues or contribute your suggestions at the project GitHub repository. "],
["get-started.html", "2 Get started 2.1 Import example form 2.2 A brief tour: Parent form 2.3 A brief tour: Observations subform 2.4 Additional options", " 2 Get started The aim of this chapter is to provide a visual tour of what a spawning ground form built using the iFormBuilder platform could look like. The first section describes how to load an example spawning ground survey form to your profile. Then the following sections provide a guided tour of the parent header form and the observations subform. The focus is on design elements, and what is visible to the surveyor on the device. Technical details on how to build forms will be addressed in chapter 3. 2.1 Import example form The quickest way to get started with mobile forms is by example. Download the Package_spawning_ground.json file from the GitHub repository for this manual. To download, click on the Package_spawning_ground.json link. You will see a list of files in the repository directory. Locate the Package_spawning_ground.json file in repository list and then click on the file. This will open a new window and display the contents of the file. Click on the *Raw&quot; button in the upper right-hand corner. This will fill your display with the raw contents of the file. You can now right-click anywhere in your display and save the contents to a convenient location on your computer. In the Save As dialog the default name for the file will be Package_spawning_ground.json.txt. Accept the default and click Save. Then navigate to the location where you saved the file and edit the name to remove the .txt part. Windows will warn you not to do this, but do it anyway. You should end up with a file name of Package_spawning_ground.json. Sign in to your iFormBuilder profile and click on the Forms tab, then click on Form Packages &gt; Package Import. In the Package Importer screen, click Choose File, navigate to where you downloaded the Package_spawning_ground.json file, and click Import. If you have existing forms in your profile make sure and select the Keep Both options in the Conflict Mode screen. After you have imported the form click on the Forms tab, then Form Assignment. You should see two new forms: spawning_ground_p and spawning_ground_s. The trailing p indicates the parent form. The trailing s indicates the subform. Highlight the row for spawning_ground_s then click Assign in the upper left corner. Uncheck the boxes for Collect and View. Then scroll to the bottom and click Update. You should never have anything but the parent form assigned to users. Open the iFormBuilder application on your mobile device. If you have done the preceeding steps correctly you should now see a form called Spawning Ground Surveys in the iFormBuilder application on your device. 2.2 A brief tour: Parent form The parent form is where you would record information that only needs to be entered once per survey. This is typically the header information you would see at the top of a paper form. Any repeating lines of data (individual observations) will be entered to a subform. The sections below assume that you have a device loaded with the example Spawning Ground form. If not, please do so now. 2.2.1 Hiding questions After you have synced the Spawning Ground form to your device, click to launch. You should see a fairly bare form. The only items showing will be some basic header information. Items include a multiselect dropdown widget for Observers, a set of select buttons for Data entry real-time or post-survey, a Survey start date &amp; time widget, a set of Survey method select buttons, a dropdown widget for Stream, and a Done button. The reason that you only see a few elements at first is that we have hidden the others using conditional logic. Hidden elements will only be revealed after prerequisite fields have been filled out. Selectively hiding elements in a form is a highly effective tool for reducing clutter and simplifying form structure. 2.2.2 Required fields Note the asterisks next to the labels for each element. This indicates required fields. If you fail to fill any of these out you will be reminded when you hit the Done button. You will not be allowed to save or submit your data until all required fields are filled in. 2.2.3 Real-time or post-survey The Data entry real-time or post-survey field illustrates how you can set up rules to show or hide elements in your form based on an initial conditions. For example, if you have some old paper data to enter and you need to use the mobile form as a post-survey data entry screen, then we know we don’t need to show widgets for recording GPS locations at a later stage. In addition, we probably won’t need to show widgets for capturing barcodes, or taking pictures. These can all be hidden if data entry type is set to post_survey. 2.2.4 Default values Notice that for the Data entry real-time or post-survey and Survey method elements we have pre-selected default values of Real-time and Foot respectively. For Survey start date &amp; time we can set a default value of the current date and time by using a JavaScript function new Date(). Setting default values is a good way to help speed up data entry in the field. Details on how to set this up is included in Chapter 3. 2.2.5 Filtered option lists The Stream, Survey start point and Survey end point elements demonstrate use of filtered option lists. Click on Stream and you will see a list of stream names. Start and stop points for stream reach sections that are typically surveyed are displayed. These are filtered to the stream you select. If you change the Stream selection, a different set of start and stop points options will be displayed. Select Bear Cr (19.0196) to see a good example of using labels to help identify filtered options. If you now click on the Survey start point pick list you will see a simple set of descriptions for the filtered points. At the bottom of each option list for start and stop points you have the ability to enter Not listed above. If you select this option two additional form elements will appear where you can enter the approximate river mile of the location and a description of the location. Ideally, all reach end points that you normally survey will already be entered to your option lists. New points can easily be added, even to a live form, but for those rare cases where the unexpected happens, it is sometimes a good idea to provide options for manual entry. Keep this to a minimum though, as it can quickly make a form overly complex and unwieldy. 2.2.6 Data validation For an example of data validation, click on the Water temperature (degree C) widget and enter the number 45, then click the Done button. You should see a message pop-up that says The start point water temperature must be between 0 and 38 degrees Celsius. These types of validations are simple to set up. Details will be provided in Chapter 3. 2.2.7 Automated entry of zero counts The Target species multiselect widget is intended as an automated way to enter zero counts. For example, if your survey is specifically targeted for Coho and Chinook, and your survey will be used to calculate population estimates, entering zero counts is crucial. By entering Coho and Chinook as target species, a zero count can automatically be entered on the backend for these species. The alternative would be to manually enter a count of zero for each species targeted. Automating the process of entering zero counts can help speed up data entry in the field. The follow-up question below asks you to specify the categories of counts where zeros should be entered. Depending on the type of survey, this question allows you to specify if zero counts should be entered for fish counts, redds counts, or both. If you are strictly conducting a redd survey you would only want zeros entered for redds. If you are only doing a carcass survey, you will want to specify Fish only. If you are conducting a complete survey, including redd, live, and carcass counts, you will want zero counts entered for Both fish and redds. 2.2.8 Toggling a subform The final header data question in the top section asks Did you see any fish or fish redds?. If you answer Yes you will open a subform where you can enter each observation. If you answer No you will only need to fill in a few remaining post-survey questions. To complete the questions on the parent form click on No to this question. 2.2.9 Survey comments and dynamic labels In the bottom portion of the parent form you are asked to enter some canned pick-list comments regarding Stream flow, Visibility conditions, and Weather. The new spawning ground database provides many additional options for canned comments adapted from legacy condition codes that you may have used in the past. I have not included these here. If you are an employee of WDFW you can see a complete list of options in the SpawningGroundDataDictionary.html located in the WDFW Fish Program shared drive under the 30Day/SpawningGround folder. Otherwise, contact me if you would like a copy. You are next asked if the survey was completed. If not, then you are asked to explain why. Toggle between answering Completed survey and any other option. Notice that the label for the Survey comments field will change from (optional) to (required). In addition, a note will appear reminding you that an explantion is needed. This is a good example of using Dynamic lables. Additional details will be provided in Chapter 3. 2.2.10 Setting optional fields to required The final two questions allow you to enter general comments on the survey, and the time the survey was finished. Both questions are technically set as optional, but remember that you will still need to enter an explanation if you did not answer Completed survey above. This demonstrates how optional fields can conditionally be set to required, without explicitly toggling the Required setting when building the form. 2.3 A brief tour: Observations subform Go back to the question Did you see any fish or fish redds? and click Yes. The Observation subform will be displayed. Click on the Observation subform to allow entering counts of fish, redds and any ancillary information. After opening the subform you will need to specify if the Observation type was for live fish, dead fish, or redds. Depending on your answers a different set of questions will be displayed. After you enter Observation type and Species toggle between Fish redd and the other two options in Observation type to see how the questions near the bottom of the screen vary. The initial set of questions after selecting Observation type and Species will be identical. They will ask about Run year, and Survey type. Each of these are core questions that are required in the form, and must be anwered in order to enter the data to our corporate database. In our example, Run year is set to the current year. You could also use JavaScript to auto-generate different values depending on species and current date. Or you can manually edit Run year as needed. Survey type can vary depending on species and survey protocol. This is why survey type is included at the subform level. For example, during a fall Chinook index survey, Pink salmon encounters may need to be entered as supplemental. Note that depending on the species selected, the text for subsequent questions will be altered to include the species name. This is another example of Dynamic labels. 2.3.1 Live fish Go back to Observation type and select Live fish, then select Chinook as Species. A relatively simple set of form elements will be displayed. After you enter a count of how many fish you saw you will see options to enter the location, along with Sex and maturity and Adipose clip status. Enter some arbitrary values for these fields and click the Done button. As soon as the form saves the record it will cycle right back to the start of the Observation subform and you can enter the next observation. The ability of the subform to cycle back to the start after saving a record is a feature you can specify when designing the form. It is called SUBFORM_BATCH_MODE. Details will be provided in Chapter 3. Notice also that the form is sticky in the sense that after you press the Done button, it remembers the Species and Survey type you entered last, and initiates the new observation with the values you used most recently. This stickiness can be useful if you typically encounter the same species repeatedly during a survey. Chapter 3 will detail how to code this behavior in the dynamic value box of a field. Change the Species to Pink and notice that the option to enter Adipose clip status dissapears. Using conditional logic you can first make a list of the species likely to have clipped fins, and then only display the Adipose clip status question when one of those species is encountered. 2.3.2 Carcass Click the Done button and cycle back to the top of the subform to enter a new observation. This time select Carcass as the Observation type and Chinook as the Species. The initial set of questions will look the same as for live fish. But if you enter a count of 2 or more for the Number of Chinook counted you will see a note reminding you that you must enter a count of 1 if you also want to enter additional biological data that is typically associated with individual fish, such as spawn condition, length measurements, or scale samples. This forces data for individual fish to be entered one fish at a time to our corporate database. If otoliths, or tissue samples for DNA analaysis are taken, the form will also assign a unique ID (UUID) that allows a single fish to be tracked in our data systems as a unique entity. If you now edit the Number of Chinook counted and enter 1, you will see a question appear asking: Did you take a sample?. If you select either Otolith or Tissue a UUID will be generated in a hidden field. You are also given the option to manually enter a Sample number. This will be appended to the front of the UUID and enables additional flexibility in tracking individual fish and sample numbers. If you enter either Beep or No beep in the Did you detect a CWT in the Chinook? a new question will appear asking what Detection method you used. Also, if you selected Adult female or Sub-adult female for the Sex and maturity question, you will be asked an optional question regarding Spawn condition of the fish. Length measurements are sometimes required when tissue samples are taken for DNA analyses. In our example form you will be asked to enter a fish length if you select either Otolith or Tissue for the Did you take a sample? question. If you enter a length you will also be asked what type of length measurement was taken. As always, both the selection of length types, and the triggers for when this question is asked, can be customized to your individual survey protocols. Go back to Number of Chinook counted and edit your answer to a number greater than one. You will still have the ability to enter a location for where you saw the group of fish. You can also enter Sex and maturity, Adipose clip status, and whether you detected coded-wire tags in the group of fish. If you answer Beep or No Beep to the question Did you detect a CWT in the Chinook you will also be asked about Detection method. However, if you detected a coded-wire tag (CWT) and need to record a CWT head label number you will be required to enter this on an individual basis. You will only have the ability to enter a CWT head label number if the Number of Chinook counted is 1. 2.3.3 Fish redd Click the Done button and cycle back to the top of the subform to enter a new observation. This time select Fish redd as the Observation type and Steelhead as the Species. Once again the first set of questions look similar, but you will now be asked to enter the Number of redds observed. If you enter a count greater than zero, you will also be asked to enter a Redd location. Notice that we have now set the Redd location question to required, as indicated by the asterisk. After you enter the location a hidden field will be generated in the background that will include only the latitude and longitude portions of the location output. For example: 47.065892: -122.887961 This is a good example of how you can pull out just the parts you need from a given data element and combine those parts in arbitrary ways to generate custom data elements. Details on how to create this element is included in chapter 3. If you enter a count greater than zero for Number of redds observed you will also be asked about Redd status. The typical options will be listed for selection, but if your protocols require additional categories, those can easily be added. You will also be asked if there were Any live Steelhead associated with the redd?. If you answer Yes you will then have the option to enter the number of Steelhead seen, the Sex and maturity, and the Adipose clip status of the live steelhead. Unlike the restrictions applied to carcass data, there are no requirements to enter data for redds on an individual basis. However, if you wanted to add questions to your form that typically require individual entries, such as redd shape, tailspill height, or substrate type, then you would need to condition those question on Redd count and only show these question if the count was one. 2.4 Additional options The example survey form described above includes most of the basic elements that would typically be needed for spawning ground surveys. Although the form has intentionally been kept simple to illustrate basic concepts, other data elements can easily be added. Questions regarding items such as gill condition, egg retention, marks or tags, would be trivial to implement. The relatively simple structure, consisting of one parent form and one subform, is sufficient to incorporate many additional data elements. You always have the option to add more subforms, but keep in mind that the simpler the structure of the form, the simpler it is build and maintain. It can quickly become challenging to reason about conditional logic when multiple subforms are involved. At that point you may find you need to pass hidden values back and forth between parent and multiple subforms. As a general rule, simpler is nearly always better. Before you add new data elements to your mobile form please take a look at the SpawningGroundDataDictionary located on the WDFW Fish Program shared drive under the 30Day/SpawningGround folder. The data dictionary for the new spawning_ground database includes tables listing a wide range of data elements that could be incorporated into mobile forms. Feel free to contact me if you have any questions. "],
["build-a-form.html", "3 Build a form 3.1 Parent form", " 3 Build a form The sections below use the Package_spawning_ground.json example form to illustrate how to build a mobile form on the iFormBuilder platform. If you have not done so already, please see the instructions in chapter 2 to load this package to your profile. Then open the iFormBuilder web interface, click on Forms &gt; Form Builder &gt; spawning_ground_p to load the example form. Chapter 2 provided a high level tour of the example spawning_ground survey form the perspective of the end-user. The focus was on the appearance and behavior of the data elements that a user would encounter on the mobile device. In Chapter 3 the focus shifts to the iFormBuilder web interface and dives into mobile form construction techniques. Details will be provided on how data elements can be defined, validated, conditionally hidden, and assigned default values. There will be special emphasis below on the core data elements that need to be present if data from a mobile form is intended for submission to our corporate spawning ground database. If a core element is missing it will not be possible to upload any of the data from your mobile form to our central database. 3.1 Parent form 3.1.1 Survey ID (core element) The first element in the parent form of any mobile form used for spawning ground surveys should be a unique survey ID. Although iFormBuilder has a widget titled Unique ID this is not a good choice for our purposes. The iFormBuilder Unique ID widget is merely a combination of a constant prefix and an integer value that increments each time you start filling out a new form. For example, D16-1, D16-2, etc. The reason that iFormBuilder’s solution is not a good choice is that it may result in generating IDs that conflict over time. For example, if after a season of using a form you decide to amend the structure, retire the old form and deploy the new version, you may end up with identical IDs for different surveys unless you also make sure to edit the prefix to some value never previously used. An alternate scenario is that you may want to create dedicated forms for different types of surveys, such as for fall Chinook, or spring Steelhead. To enfore uniqueness statewide there would need to be coordination in assigning prefixes over WDFW districts and regions, otherwise new forms may start incrementing overlapping IDs. An even more important reason for adding a truly unique survey ID element to our forms is that it can then be used as a primary key in our corporate database. To that end what we need is a unique identifier that is (virtually) guaranteed to always be unique. The solution is to use a random uuid (universally unique ID). A version 4 uuid can be generated using the JavaScript code below. See the following link at Stackoverflow for the source of the function. function generateUUID () { // Public Domain/MIT var d = new Date().getTime(); if (typeof performance !== &#39;undefined&#39; &amp;&amp; typeof performance.now === &#39;function&#39;){ d += performance.now(); //use high-precision timer if available } return &#39;xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx&#39;.replace(/[xy]/g, function (c) { var r = (d + Math.random() * 16) % 16 | 0; d = Math.floor(d / 16); return (c === &#39;x&#39; ? r : (r &amp; 0x3 | 0x8)).toString(16); }); } You can copy and paste this function directly into the JavaScript panel of your parent form. To access the JavaScript panel click on the curly braces icon {} in the top right corner of the Forms page when using the online Form Builder application. Make sure you paste the function into the JavaScript panel for your parent form, not the subform. You can then go back to the form builder interface and create a read-only element in your parent form by clicking on the Read Only widget in the left-hand pane. The name of the element in the Element Properties pane on the right-hand side should be survey_uuid. Enter Unique survey ID as the label. In the Dynamic Value box in the Element Properties pane on the right-hand side enter the following: generateUUID() Leave the Condition Value set to false. That way it will be invisible to the surveyor. The survey_uuid element will generate a universally unique ID every time a form is initiated that will look something like: 33b78489-7ad3-4482-9455-3988e05bfb28 There are 2122 possible combinations for a randomly generated version 4 uuid. In practical terms this means that if you generate one billion UUIDs every second for approximately 85 years, the probability that two identical UUIDs will be generated is still only about 50%. See article at Wikipedia. 3.1.2 Data source (core element) Click on the Data source label in the form view on the left-hand side of the form-builder pane. Then examine the Element Properties in the right-hand pane. The data_source element will typically be another read-only field. It can be hard-coded as &quot;wdfw&quot; in the Dynamic Value box of the Smart Control. You can set the Condition Value to false to hide it from view. On the off-chance that your form will be shared with other organizations, you can also change this element to a select widget. You will then need to create an option list that includes all organizations using the form. Examples of how to create option lists and use select values are provided in the sections below. For now, let’s just assume data_source will be a hidden, read-only data element. 3.1.3 Observers Click on Observers in the form view. Although observers is not a core required element it is highly recommended that you include this multi-select widget. In the example form it has been set to Required in the Attributes section of the Element properties pane. Click on the green Option lists button to see the observers currently listed. A screen will appear that allows you to assign option lists to data elements. Multi-select widgets allow you to select one or more of the options listed. If more than one is selected the last names (Key Value) will be concatenated together, separated by commas and a space, for example, `Smith, Jones, Nelson’. 3.1.4 Data submitter The data_submitter element is another hidden field that is not required, but good practice to include. The data_submitter value is auto-generated in the background, and identifies the person who was logged into the mobile device when the the survey Done button was clicked. The data are derived from default meta-data fields provided by iFormBuilder. To create this element you click on the Text widget in the left-hand sidebar and check the Read-Only box in the Attributes section of the Element Properties box on the right-hand side. In the Dynamic Value box of the Smart Control pane, enter: iformbuilder.lastName There are several built-in functions you can use to generate data such a this. See the JavaScript Tips and Tricks section for additional examples of how these built-in functions can be used. To hide this field so it does not clutter up your display when conducting a survey, you can set the Condition Value to false. 3.1.5 Entry method The Data entry real-time or post-survey? field allows for selectively hiding or showing fields depending on the method used to record data in the field; whether on a mobile device, or on paper. There may be occasions where you need to enter data that was originally recorded on paper. In this case, fields for capturing GPS locations, barcodes, or images would be largely irrelevant. The two options are: Real-time or Post-survey. Click on the green Option Lists bar in the Option List box to see how these options are structured. Notice the Sort Order column in the option list. You can use these values to specify a default answer to display. If you enter 0 in the Dynamic Value box the default value will be Real-time, entering 1 would set the default value to Post-survey. If you do not want to set a default value you can enter -1. Setting a dynamic value of -1 is an explicit way to say the value is currently missing. It is good practice to always initialize select, multi-select, or pick-list widgets with either a default value or -1. Another way to set default values is to reference either the option list Label or Key Value instead. You would simply preface the field name with ZCDisplayLabel or ZCDisplayKey. For example, ZCDisplayLabel_species or ZCDisplayLabel_redd_status. In the case of simple lists such as entry_method using Sort Order as a reference is acceptable. There are only two values to remember. For more more complex cases, however, where there are many options, and possibly conditional logic tied to those option values, it is nearly always better to reference the Label or Key Value instead. The reason is that you are then constructing logical statements with actual understandable names rather than just numbers. For example, once your brain gets past the ugly ZCDisplayKey portion, it’s much easier to understand statements such as: if(ZCDisplayKey_species == &quot;coho&quot; &amp;&amp; ZCDisplayKey_redd_status == &quot;new_redd&quot;) {&quot;Yes&quot;} else {&quot;No&quot;} Rather than: if(species == 3 &amp;&amp; redd_status == 0) {&quot;Yes&quot;} else {&quot;No&quot;} Aside from not having to remember the sort_order values in order to understand what is actually being stated, using Key Values or Labels also avoids having to change the statements if you later need to edit the option list and inadvertantly shuffle the sort_order values assigned to each option. 3.1.6 Survey start date (core element) The survey_start_datetime field is a core element. There are several methods to add a date or date-time field to your form. The example form shows perhaps the most common method, but see the: JavaScript Tips and Tricks section for alternative methods. Because it is a core field, and it is not hidden, you will need to check Required in the Attributes box of Element Properties. Note also that the Dynamic Value is generated using a JavaScript function: new date() 3.1.7 Survey method (core element) The survey_method field is another core element. If you click on the green Option Lists bar the Assign Option Lists window will open and you will see there are only three options listed: Foot, Raft, and Helicopter. Several additional options that you may want to add are listed in the SpawningGroundDataDictionary mentioned in chapter 2. If you need to add an option, for example Snorkle, close the Assign Option Lists window and click on Option Lists in the top left-hand corner of the form builder application. A window showing all option lists in your profile will open. Scroll down to the SGS-SurveyMethod option list and click on it. This will open a new window where you can view and edit the SGS-SurveyMethod list. Next, click on the green plus sign at the bottom of the Actions column on the far right. A new row will appear, and a new sequential sort_order number will be automatically assigned. You can then enter Snorkle in the Label column, and a lower case snorkle in the Key Value column. The Key Value name should always be in lower case. Underscores should be used for compound names, such as new_redd. Don’t forget to click the Save icon before closing the Option Lists window. Switch back to the form builder view and notice that the default value for survey_method has been set to 0 in the Dynamic Value box. This means that the default value displayed on the device will be Foot. Since most spawning ground surveys tend to be Foot surveys, this setting allows you to quickly skim by this element when entering header data. If you prefer to manually select a survey_method each time, you can set the Dynamic Value to -1 instead. 3.1.8 Stream (core element) As mentioned in Chapter 2, you must select a stream before any additional fields in your example form become visible. You will then be able to select start and end points for your survey along the selected stream. Only points belonging to the stream you select will be visible. This is an example of a filtered option list. If you click on the green Option List bar for the stream element and scroll through the option lists on the left-hand side of the pop-up window, you will see an SGS-Streams option list and a SGS-StreamLocations option list. There are 38 options in the SGS-Streams list, and 210 options in the SGS-StreamLocations list. Option lists for streams and locations in your area may end up being longer. Given the number of elements involved you will want the Element Type to be a Pick List. Close this pop-up window and select Option Lists in the upper left-hand corner of the Form Builder page. Scroll down and click on SGS-Streams to see how this option list is defined. One defining feature of option lists is that the Key Values must all be unique. For this reason you do not want to use the stream name as the key value. There can be multiple Boulder Creeks, or Cedar Creeks within any given watershed. Using the Stream Catalog Code (i.e. 17.0213) is also problematic since there are areas in the state where smaller streams may not have been assigned a code. The solution is to use the unique integer ID from the old Spawning Ground Survey (SGS) database for the Key Value. 3.1.9 Survey start point (core element) Every survey must have a start and stop point. Click on Option Lists again in the top-left corner of the form builder and select SGS-StreamLocations to see how these points are defined. The Label lists the river mile of the point, along with a short description: RM 0.00: Mouth. This is the part that will be visible when using the form. The Key Value is a combination of the integer ID of the stream combined with an underscore separator and finally the river mile formatted to three digits before the decimal and two digits after the decimal. This ensures that the Key Value will always be unique and of consistent length. To see how this list is filtered by stream click on the Condition Value button in the upper-left hand corner of the option list window. This will turn the button from gray to green and reveal the Condition Value column in the option list. Setting condition values in option lists follows the same rules as showing or hiding data elements in a form. You can use the same ZCDisplayKey or ZCDisplayValue terminology as when setting Element properties in the form builder interface. If you want to temporarily hide an option from view, you can also set the Condition Value to false. In the example above, the five options at the top of the SGS-StreamLocations option list will only be visible if the key_value for the stream you selected was 285. The convention for coding Key values for locations that are Not listed above is to concatenate a zero with an underscore and the stream ID. For example: 0_285. This ensures that no duplicate Key Values will be entered to the option list. Option lists such as SGS-StreamLocations, with upwards of 210 elements and 38 different condition values, can be tedious to create by hand. A better option is to create and write such lists directly to the iFormBuilder cloud using scripts. This can be accomplished in seconds using the iformr package for the R programming language. See the package documentation for usage examples. I can also provide example scripts. 3.1.10 Start point not listed If the Label of a selected start_point or end_point is Not listed above, then additional data elements for entering those points manually in the form will be revealed. The Start point not listed and End point not listed elements are both set as Element Type Text. Numeric, but use text. Reason: easier to deal with. Set keyboard to number and punct. Add GPS? Add photo? "],
["todo.html", "4 ToDo", " 4 ToDo Finish iformr package. Text indicates a package. Finish spawning ground form. Link to new json package. Discuss subform batch mode Demonstrate how to download data? Write up steps to create and activate branch in remote "],
["notes-on-bookdown.html", "5 Notes on bookdown 5.1 Files needed to build basic book: 5.2 Building these files generates:", " 5 Notes on bookdown 5.1 Files needed to build basic book: .gitignore .Rbuildignore Index and 01-0n.Rmd files _build.sh (enables the build all command) book.bib 5.2 Building these files generates: book.bib _book (folder) .html files (generated from Index and 01-0n.Rmd files) search_index.json libs (folder) gitbook-2.6.7 (folder) jquery-2.2.3 (folder) "],
["references.html", "References", " References "]
]
